<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Draft | ROV SN TOURNAMENT</title>
    <!-- Tailwind CSS (built locally) -->
    <link rel="stylesheet" href="dist/output.css">
    <!-- Font Awesome Icons -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <!-- Favicon -->
    <link rel="icon" href="RoV Logo.png" type="image/png">
    <!-- Custom Styles -->
    <link rel="stylesheet" href="styles.css">
    
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Kanit:wght@300;400;600&display=swap');

        body {
            font-family: 'Kanit', sans-serif;
        }

        /* Additional inline animations */
        @keyframes popIn {
            0% { transform: scale(0.9); opacity: 0; }
            60% { transform: scale(1.02); opacity: 1; }
            100% { transform: scale(1); opacity: 1; }
        }

        .animate-pop-in {
            animation: popIn 1s ease-out forwards;
        }

        .animation-delay-200 { animation-delay: 0.2s; }
        .animation-delay-400 { animation-delay: 0.4s; }

        /* Smooth app fade-in after loading */
        @keyframes fadeInSoft {
            0% { opacity: 0; transform: translateY(6px); }
            100% { opacity: 1; transform: translateY(0); }
        }
        .app-hidden { opacity: 0; }
        .app-fade-in { animation: fadeInSoft 220ms ease-out forwards; }

        /* Scale logo when hiding (no blur for clarity) */
        .scale-out { transform: scale(0.92); transition: transform 700ms ease; }

        /* Make logo rendering crisper during animation */
        .logo-clear { backface-visibility: hidden; transform: translateZ(0); image-rendering: -webkit-optimize-contrast; }
    </style>
</head>
<body class="text-gray-800 relative">

    <!-- Loading Screen (Logo only) -->
    <div id="loadingScreen" class="fixed inset-0 bg-[#E8F7FF] z-[100] flex items-center justify-center transition-opacity duration-900 ease-in-out">
        <div class="w-40 h-40 md:w-56 md:h-56 bg-white rounded-full shadow-2xl flex items-center justify-center border-4 border-[#15C8FF] animate-pulse-logo overflow-hidden p-2">
            <img src="RoV Logo.png" class="w-full h-full object-cover rounded-full animate-pop-in logo-clear" alt="RoV Logo">
        </div>
    </div>

    <div id="appMain" class="container mx-auto px-4 py-8 max-w-4xl app-hidden">
        <!-- Header -->
        <div class="text-center mb-8">
            <h1 class="text-3xl md:text-4xl font-bold text-gray-900 mb-2">üèÜ ROV SN TOURNAMENT 2026</h1>
            <p class="text-gray-500">League Phase: Modified Partial Round-Robin (BO3)</p>
            <p class="text-sm mt-2">Database: <span id="dbConnectionStatus" class="font-bold text-yellow-600">Checking MongoDB...</span></p>
        </div>

        <!-- Team Input Section -->
        <div class="bg-white rounded-xl shadow-sm p-6 mb-6 border-t-4 border-primary">
            <div class="flex justify-between items-center mb-4">
                <h2 class="text-lg font-semibold flex items-center">
                    <i class="fas fa-users-cog mr-2 text-primary"></i> ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏ó‡∏µ‡∏°‡πÅ‡∏Ç‡πà‡∏á (16 ‡∏ó‡∏µ‡∏°)
                </h2>
                <!-- Connection Status -->
                <div class="text-xs px-2 py-1 rounded bg-gray-100 flex items-center cursor-help" title="‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠ MongoDB Server">
                    <div id="statusDot" class="w-2 h-2 rounded-full bg-yellow-500 mr-2"></div> 
                    <span id="statusText">Check Server...</span>
                </div>
            </div>
            <textarea id="teamsInput" rows="6" class="w-full p-3 border border-gray-200 rounded-lg focus-ring-theme transition text-sm bg-gray-50 font-mono" placeholder="‡∏Å‡∏£‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠‡∏ó‡∏µ‡∏° (‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î‡∏•‡∏∞ 1 ‡∏ó‡∏µ‡∏°)">Team 1
Team 2
Team 3
Team 4
Team 5
Team 6
Team 7
Team 8
Team 9
Team 10
Team 11
Team 12
Team 13
Team 14
Team 15
Team 16</textarea>
            
            <div class="mt-4 grid grid-cols-1 md:grid-cols-2 gap-4">
                <button id="generateBtn" type="button" class="bg-primary bg-primary-hover text-white font-bold py-3 px-4 rounded-lg transition duration-200 shadow-md flex justify-center items-center text-lg transform hover:scale-[1.01] active:scale-[0.99]">
                    <i class="fas fa-play-circle mr-2"></i> ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÅ‡∏•‡∏∞‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å (Generate & Save)
                </button>
                <button onclick="checkServerStatus()" class="bg-gray-100 hover:bg-gray-200 text-gray-700 font-bold py-3 px-4 rounded-lg transition duration-200 border border-gray-300 flex justify-center items-center">
                    <i class="fas fa-sync-alt mr-2"></i> ‡πÄ‡∏ä‡πá‡∏Ñ‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡πÉ‡∏´‡∏°‡πà
                </button>
            </div>
            <p id="errorMsg" class="text-red-500 text-sm mt-2 hidden"></p>
        </div>

        <!-- Status & Logs -->
        <div id="notificationArea" class="hidden mb-6 p-4 rounded-lg border"></div>

        <!-- Results Section -->
        <div id="resultsArea" class="hidden space-y-8">
            <!-- Pots Display -->
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <!-- Pot A -->
                <div class="bg-white rounded-xl shadow-sm overflow-hidden border border-gray-100 animate-fade-in" style="animation-delay: 0.1s;">
                    <div class="bg-gradient-to-r from-cyan-500 to-blue-500 text-white p-3 text-center font-bold relative overflow-hidden">
                        <span class="relative z-10">üîµ POT A</span>
                    </div>
                    <div class="p-4">
                        <ul id="potAList" class="space-y-2 text-sm"></ul>
                    </div>
                </div>

                <!-- Pot B -->
                <div class="bg-white rounded-xl shadow-sm overflow-hidden border border-gray-100 animate-fade-in" style="animation-delay: 0.2s;">
                    <div class="bg-gradient-to-r from-red-500 to-orange-500 text-white p-3 text-center font-bold relative overflow-hidden">
                        <span class="relative z-10">üî¥ POT B</span>
                    </div>
                    <div class="p-4">
                        <ul id="potBList" class="space-y-2 text-sm"></ul>
                    </div>
                </div>
            </div>

            <!-- Schedule -->
            <div class="bg-white rounded-xl shadow-sm p-6 border-t-4 border-primary animate-fade-in" style="animation-delay: 0.3s;">
                <div class="flex justify-between items-center mb-6">
                    <h2 class="text-xl font-bold flex items-center">
                        <i class="fas fa-calendar-alt mr-2 text-gray-700"></i> ‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡πÅ‡∏Ç‡πà‡∏á‡∏Ç‡∏±‡∏ô
                    </h2>
                    <div class="text-xs font-bold text-primary bg-[var(--secondary)] px-3 py-1 rounded-full border border-primary">
                        Total: 8 Match Days
                    </div>
                </div>

                <!-- View Tabs -->
                <div class="flex border-b border-gray-200 mb-4">
                    <button onclick="switchTab('list')" id="tab-list" class="flex-1 py-2 text-center tab-active hover:bg-gray-50 transition">
                        ‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏° (List)
                    </button>
                    <button onclick="switchTab('day')" id="tab-day" class="flex-1 py-2 text-center tab-inactive hover:bg-gray-50 transition">
                        ‡πÅ‡∏¢‡∏Å‡∏ï‡∏≤‡∏°‡∏ß‡∏±‡∏ô (By Day)
                    </button>
                </div>

                <!-- List View -->
                <div id="view-list" class="overflow-x-auto">
                    <table class="w-full text-sm text-left border-collapse">
                        <thead class="bg-[var(--secondary)] text-gray-700 uppercase font-semibold">
                            <tr>
                                <th class="px-4 py-3 rounded-l-lg text-primary">Day</th>
                                <th class="px-4 py-3">Phase</th>
                                <th class="px-4 py-3 text-right">Blue Side</th>
                                <th class="px-4 py-3 text-center">VS</th>
                                <th class="px-4 py-3 text-left">Red Side</th>
                                <th class="px-4 py-3 rounded-r-lg">Format</th>
                            </tr>
                        </thead>
                        <tbody id="scheduleTableBody" class="divide-y divide-gray-100"></tbody>
                    </table>
                </div>

                <!-- Day View -->
                <div id="view-day" class="hidden space-y-4"></div>
            </div>
        </div>
    </div>

    <!-- Match Reveal Modal -->
    <div id="revealModal" class="fixed inset-0 bg-gray-900 bg-opacity-95 flex items-center justify-center z-50 hidden backdrop-blur-md transition-opacity duration-300">
        <div class="w-full max-w-3xl mx-4 relative">
            
            <!-- Skip Button -->
            <button onclick="skipAnimation()" class="absolute -top-12 right-0 text-white text-sm hover:text-primary transition flex items-center bg-gray-800 px-3 py-1 rounded-full border border-gray-700 z-50">
                <i class="fas fa-forward mr-2"></i> ‡∏Ç‡πâ‡∏≤‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î (Skip)
            </button>

            <!-- Reveal Card -->
            <div class="reveal-card bg-white rounded-3xl shadow-2xl overflow-hidden text-center relative p-8 border-4 border-primary/20">
                
                <!-- Match Day Header -->
                <div class="mb-8">
                    <span id="revealDayBadge" class="bg-primary text-white px-4 py-1 rounded-full text-sm font-bold uppercase tracking-widest shadow-lg animate-slide-up">
                        Match Day 1
                    </span>
                    <h2 id="revealPhase" class="text-gray-400 text-sm mt-3 uppercase tracking-wider font-semibold animate-slide-up" style="animation-delay: 0.1s;">
                        Internal Phase
                    </h2>
                </div>

                <!-- Matchup -->
                <div class="flex flex-col md:flex-row items-center justify-center gap-6 md:gap-10 my-8">
                    
                    <!-- Team Blue -->
                    <div class="flex-1 w-full animate-scale-up" style="animation-delay: 0.2s;">
                        <div class="bg-blue-50 border-2 border-blue-100 rounded-2xl p-6 shadow-sm hover:shadow-md transition transform hover:-translate-y-1">
                            <div class="text-blue-500 text-xs font-bold uppercase mb-2">Blue Side</div>
                            <div id="revealTeamA" class="team-name-lg text-blue-700 break-words leading-tight">Team A</div>
                        </div>
                    </div>

                    <!-- VS Badge -->
                    <div class="animate-pop-in" style="animation-delay: 0.4s;">
                        <div class="vs-badge-lg rounded-full bg-gradient-to-br from-gray-800 to-gray-900 text-white flex items-center justify-center font-black border-4 border-white z-10 relative">
                            VS
                        </div>
                    </div>

                    <!-- Team Red -->
                    <div class="flex-1 w-full animate-scale-up" style="animation-delay: 0.3s;">
                        <div class="bg-red-50 border-2 border-red-100 rounded-2xl p-6 shadow-sm hover:shadow-md transition transform hover:-translate-y-1">
                            <div class="text-red-500 text-xs font-bold uppercase mb-2">Red Side</div>
                            <div id="revealTeamB" class="team-name-lg text-red-700 break-words leading-tight">Team B</div>
                        </div>
                    </div>

                </div>

                <!-- Footer / Progress -->
                <div class="mt-8">
                    <div class="text-gray-400 text-xs mb-2 flex justify-between">
                        <span id="matchCounter">Match 1 of 8 (Day 1)</span>
                        <span class="animate-pulse text-primary">Live Revealing...</span>
                    </div>
                    <div class="w-full bg-gray-100 rounded-full h-2 overflow-hidden">
                        <div id="revealProgressBar" class="bg-primary h-2 rounded-full transition-all duration-500" style="width: 0%"></div>
                    </div>
                </div>

            </div>
        </div>
    </div>

    <!-- MongoDB API Configuration -->
    <script>
        // MongoDB API endpoint configuration
        var __api_config = {
            baseURL: 'https://rov-sn-tournament-api.vercel.app/api',
            endpoints: {
                health: '/health',
                schedules: '/schedules'
            },
            timeout: 3000
        };
    </script>

    <!-- Fallback: hide loading screen even if main script fails (3s delay) -->
    <script>
        (function() {
            const hide = () => {
                const el = document.getElementById('loadingScreen');
                if (!el) return;
                const logo = el.querySelector('img');
                if (logo) logo.classList.add('scale-out');
                el.classList.add('opacity-0');
                // Start app fade-in immediately for snappier feel
                const app = document.getElementById('appMain');
                if (app) {
                    app.classList.remove('app-hidden');
                    app.classList.add('app-fade-in');
                }
                // Match overlay transition duration
                setTimeout(() => {
                    el.style.display = 'none';
                }, 900);
            };
            // Hide after 3s regardless
            window.addEventListener('DOMContentLoaded', () => setTimeout(hide, 3000));
            window.addEventListener('load', () => setTimeout(hide, 3000));
        })();
    </script>

    <!-- App Script -->
    <script type="module" src="script.js"></script>

</body>
</html>